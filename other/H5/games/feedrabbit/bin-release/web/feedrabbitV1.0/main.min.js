var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},Main=function(t){function e(){var e=t.call(this)||this;return e.Step=15,e.TimeSlice=100,e.DefaultBackTime=1e3,e.sum=0,e.Time_Game=Constants.Time_Game,e.round=1,e.target_score=Constants.TargetScore_Round1,e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},e.prototype.showStartingUI=function(){var t=this;this.startingUI=new StartingUI,this.stage.addChild(this.startingUI),this.startingUI.button.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.createGameScene()},this)},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.showStartingUI()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){var t=this;this.stage.removeChild(this.startingUI),this.grass=this.createBitmapByName("bkg_png"),this.addChild(this.grass);var e=this.stage.stageWidth,n=this.stage.stageHeight;this.grass.width=e,this.grass.height=n;var i=new egret.Point(.2*this.grass.width,50);console.log(i.toString()),this.farmland=new Farmland,this.farmland.x=i.x,this.farmland.y=i.y,this.addChild(this.farmland),console.log("the location of the farmland is "+this.farmland.localToGlobal().toString()),this.constants=new Constants;[new Article("carrot_png",1.2),new Article("carrot_png",1.5),new Article("dandelion_png",2),new Article("stone2_png",.3),new Article("soil_png",.6),new Article("cabbage_png",1)],[new egret.Point(30,30),new egret.Point(30,this.farmland.height-30),new egret.Point(this.farmland.width,0),new egret.Point(.5*this.farmland.width,.5*this.farmland.height),new egret.Point(this.farmland.width,this.farmland.height),new egret.Point(200,200)];this.setFarmland(this.constants.Article_Round1,Constants.Locations_Round1),this.initialPoint=new egret.Point(.809*e-50,.5*n+50),this.farmer=new Farmer("farmer_png",this.initialPoint,this.farmland),this.farmer.x=this.initialPoint.x,this.farmer.y=this.initialPoint.y,this.farmer.stand(),this.addChild(this.farmer),this.pointer=new Pointer,this.pointer.x=this.initialPoint.x-30,this.pointer.y=this.initialPoint.y,this.addChild(this.pointer),this.pointer.run(),console.log("the angle is 195.5 and cos and sin are "+Math.cos(195.5)+" sin is "+Math.sin(195.5)),this.grass.touchEnabled=!0,this.grass.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t.angle=(180-t.pointer.angle)/180*Math.PI,console.log("the angle now is "+t.angle),t.pointer.stop(),t.moveFarmer()},this),this.textField_Sum=new egret.TextField,this.setTextForm(this.textField_Sum,1050,590),this.addChild(this.textField_Sum),this.timeShow=new egret.TextField,this.setTextForm(this.timeShow,500,10),this.addChild(this.timeShow),this.roundShow=new egret.TextField,this.setTextForm(this.roundShow,1e3,10),this.addChild(this.roundShow),this.textField_Message=new egret.TextField,this.setTextForm(this.textField_Message,800,600),this.addChild(this.textField_Message),this.showMessage(),this.showScore(),this.showRound(),this.transitionPlay(0),this.mutiShow(),this.target_TextField=new egret.TextField,this.addChild(this.target_TextField),this.target_TextField.text,this.target_TextField.size=Constants.size_targetscore,this.target_TextField.x=Constants.location_targetscore.x,this.target_TextField.y=Constants.location_targetscore.y,this.target_TextField.textAlign=egret.HorizontalAlign.LEFT,this.target_TextField.textColor=0,this.target_TextField.type=egret.TextFieldType.DYNAMIC,this.target_TextField.lineSpacing=6,this.target_TextField.multiline=!0,this.showTargetScore(),this.setTimer(),this.tip=new Transition,this.tip.x=.3*this.width,this.tip.y=.3*this.height,this.addChild(this.tip),this.rabbit=new Rabbit,this.rabbit.x=Constants.Point_Rubbit.x,this.rabbit.y=Constants.Point_Rubbit.y,this.rabbit.anchorOffsetX=.5*this.rabbit.width,this.rabbit.anchorOffsetY=.5*this.rabbit.height,this.rabbit.stand(),this.addChild(this.rabbit),this.worm=new Worm,this.worm.visible=!1,this.worm.x=Constants.Point_Worm_Start.x,this.worm.y=Constants.Point_Worm_Start.y,this.progress_bar=new eui.ProgressBar,this.progress_bar.width=200,this.progress_bar.height=11,this.progress_bar.maximum=Constants.Time_Game,this.progress_bar.minimum=0,this.addChild(this.progress_bar),this.progress_bar.x=Constants.loc_progress_bar.x,this.progress_bar.y=Constants.loc_progress_bar.y,this.progress_bar.value=Constants.Time_Game,this.loadEatRabbit(),this.setEnd()},e.prototype.loadEatRabbit=function(){var t=RES.getRes("rabbit_eat_ske_json"),e=RES.getRes("rabbit_eat_tex_json"),n=RES.getRes("rabbit_eat_tex_png"),i=new dragonBones.EgretFactory;i.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,e));var o=i.buildArmatureDisplay("rabbit_eat");o.scaleX=o.scaleY=Constants.Scale_Rabbit_End,o.anchorOffsetX=.2*o.width*.5,o.anchorOffsetY=.2*o.height,this.rabbit_eat=o,this.rabbit_eat.visible=!1,this.rabbit_eat.x=Constants.Point_Rabbit_End.x,this.rabbit_eat.y=Constants.Point_Rabbit_End.y,this.addChild(this.rabbit_eat)},e.prototype.setTextForm=function(t,e,n){t.size=32,t.x=e,t.y=n,t.textAlign=egret.HorizontalAlign.LEFT,t.textColor=16711680,t.type=egret.TextFieldType.DYNAMIC,t.lineSpacing=6,t.multiline=!0},e.prototype.printTheLocation=function(t){console.log("( "+t.x+", "+t.y+" )")},e.prototype.moveTo=function(t,e,n){var i=egret.Tween.get(t);return i.to({x:e.x,y:e.y},n),i},e.prototype.moveFarmer=function(){var t=this;this.grass.touchEnabled=!1,this.pointer.stop();var e,n=(this.farmland.$children,this.getAllTheArticlesAnchor(this.farmland));this.farmer.run();var i=function(){var o=t.farmer.localToGlobal(),s=o.x+t.Step*Math.cos(t.angle),a=o.y-t.Step*Math.sin(t.angle),r=new egret.Point(s,a);console.log("the location now is "+o.toString()),console.log("the next point is "+r.toString()),console.log("the angle is "+t.angle);var h=t.moveTo(t.farmer,r,t.TimeSlice);if(e=t.isHitSomething(t.farmer,n),e>=0){t.farmer.dig(),console.log("the target's loc is "+e);var l=t.farmland.getChildAt(e),c=l.backTime;t.farmer.back(c),t.sum+=l.score,t.farmland.removeChild(l),t.moveTo(t.farmer,t.initialPoint,c).call(function(){t.pointer.run(),t.showScore(),t.farmer.stand()}).wait(100).call(function(){t.grass.touchEnabled=!0})}else t.isOutOfFarmland(t.farmer)?(t.farmer.back(t.DefaultBackTime),t.moveTo(t.farmer,t.initialPoint,t.DefaultBackTime).call(function(){t.farmer.stand(),t.pointer.run()}).wait(100).call(function(){0==t.Time_Game?t.grass.touchEnabled=!1:t.grass.touchEnabled=!0})):0==t.Time_Game?(t.farmer.back(t.DefaultBackTime),t.moveTo(t.farmer,t.initialPoint,t.DefaultBackTime).call(function(){t.farmer.stand(),t.pointer.run()}).wait(100).call(function(){t.grass.touchEnabled=!1})):h.call(i)};i()},e.prototype.setEnd=function(){this.end_show=this.createBitmapByName("end_png"),this.end_show.anchorOffsetX=.5*this.end_show.width,this.end_show.anchorOffsetY=.8*this.end_show.height,this.end_show.x=Constants.Point_Congratuations.x,this.end_show.y=Constants.Point_Congratuations.y,this.end_show.visible=!1,this.addChild(this.end_show)},e.prototype.showEnd=function(){var t=this;this.grass.touchEnabled=!1,this.pointer.stop(),this.timer.stop(),this.end_show.visible=!0;var e=egret.Tween.get(this.end_show);return e.call(function(){t.end_show.scaleX=t.end_show.scaleY=2*Constants.Scale_Congratuations}).wait(300).call(function(){t.end_show.scaleX=t.end_show.scaleY=Constants.Scale_Congratuations}),this.rabbit_eat.visible=!0,this.rabbit_eat.animation.play("eat",0),e},e.prototype.closeEndShow=function(){this.end_show.visible=!1,this.rabbit_eat.visible=!1},e.prototype.showWorm=function(){var t;t=egret.Tween.get(this.worm,{loop:!0}),this.worm.visible=!0,t.to({x:Constants.Point_Worm_End.x,y:.5*Constants.Point_Worm_End.y},Constants.Time_Worm).wait(300).to({x:Constants.Point_Worm_End.x,y:Constants.Point_Worm_End.y},Constants.Time_Worm).wait(300).to({x:Constants.Point_Worm_Start.x,y:.5*Constants.Point_Worm_End.y},Constants.Time_Worm).wait(300).to({x:Constants.Point_Worm_Start.x,y:Constants.Point_Worm_Start.y},Constants.Time_Worm).wait(300)},e.prototype.transitionPlay=function(t){var e,n=this;switch(t){case 0:var i=this.createBitmapByName("Round1_png");i.visible=!1,i.x=.35*this.width,i.y=10,this.addChild(i),e=egret.Tween.get(i),e.to({x:Constants.Point_Round.x,y:.5*Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){i.visible=!0}).to({x:Constants.Point_Round.x,y:Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){i.scaleX=i.scaleY=Constants.Scale_Round}).wait(500).to({x:.5*Constants.Point_Final.x,y:.5*Constants.Point_Final.y},.5*Constants.Time_Tween).call(function(){i.scaleX=i.scaleY=Constants.Scale_Final}).wait(100).to({x:Constants.Point_Final.x,y:Constants.Point_Final.y},.5*Constants.Time_Tween);break;case 1:var o=this.createBitmapByName("Round2_png");o.visible=!1,o.x=.35*this.width,o.y=10,this.addChild(o),e=egret.Tween.get(o),e.to({x:Constants.Point_Round.x,y:.5*Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){o.visible=!0}).to({x:Constants.Point_Round.x,y:Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){o.scaleX=o.scaleY=Constants.Scale_Round}).wait(500).to({x:.5*Constants.Point_Final.x,y:.5*Constants.Point_Final.y},.5*Constants.Time_Tween).call(function(){o.scaleX=o.scaleY=Constants.Scale_Final}).wait(100).to({x:Constants.Point_Final.x,y:Constants.Point_Final.y},.5*Constants.Time_Tween);break;case 2:var s=this.createBitmapByName("Round3_png");s.visible=!1,s.x=.35*this.width,s.y=10,this.addChild(s),e=egret.Tween.get(s),e.to({x:Constants.Point_Round.x,y:.5*Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){s.visible=!0}).to({x:Constants.Point_Round.x,y:Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){s.scaleX=s.scaleY=Constants.Scale_Round}).wait(500).to({x:.5*Constants.Point_Final.x,y:.5*Constants.Point_Final.y},.5*Constants.Time_Tween).call(function(){s.scaleX=s.scaleY=Constants.Scale_Final}).wait(100).to({x:Constants.Point_Final.x,y:Constants.Point_Final.y},.5*Constants.Time_Tween);break;case 3:var a=this.createBitmapByName("Round4_png");a.visible=!1,a.x=.35*this.width,a.y=10,this.addChild(a),e=egret.Tween.get(a),e.to({x:Constants.Point_Round.x,y:.5*Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){a.visible=!0}).to({x:Constants.Point_Round.x,y:Constants.Point_Round.y},.5*Constants.Time_Tween).call(function(){a.scaleX=a.scaleY=Constants.Scale_Round}).wait(500).to({x:.5*Constants.Point_Final.x,y:.5*Constants.Point_Final.y},.5*Constants.Time_Tween).call(function(){a.scaleX=a.scaleY=Constants.Scale_Final}).wait(100).to({x:Constants.Point_Final.x,y:Constants.Point_Final.y},.5*Constants.Time_Tween);break;case 4:e=this.showEnd(),e.wait(Constants.Time_Stay).call(function(){n.closeEndShow(),n.round=0,n.sum=0,n.Time_Game=Constants.Time_Game,n.isPassed=!0,n.update()})}return e},e.prototype.backToInitialPoint=function(t,e){},e.prototype.getTheNearPoints=function(t){for(var e=[],n=Constants.Size_Block,i=50,o=0;n>o;o++)for(var s=0;i>s;s++)e[s+n*o]=new egret.Point(t.x+o-.5*n,t.y+s-.5*i);return e},e.prototype.getAllTheArticlesAnchor=function(t){for(var e=t.$children,n=[],i=0;i<e.length;i++)n[i]=e[i].localToGlobal();return n},e.prototype.isOutOfFarmland=function(t){var e=(this.farmland.width,this.farmland.height),n=this.farmland.localToGlobal(),i=t.localToGlobal(),o=n.x+.2*t.width,s=n.y+.7*t.height,a=n.y+e+.5*t.height;return console.log("the width of farmer is "+t.width),console.log("the height of farmer is "+t.height),console.log("the lefEdge is "+o),console.log("the upEdge is "+s),console.log("the downEdge is "+a),console.log("the anchor of the farmer is "+i.toString()),i.x<o?!0:i.y<s?!0:i.y>a?!0:!1},e.prototype.isHitSomething=function(t,e){for(var n=-1,i=0;i<e.length;i++)if(this.isHitOnePoint(this.farmer,e[i])){n=i;break}return n},e.prototype.isHitOnePoint=function(t,e){for(var n=this.getTheNearPoints(e),i=0;i<n.length;i++)if(t.shade.hitTestPoint(n[i].x,n[i].y))return!0},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e.prototype.quit=function(){},e.prototype.update=function(){var t=this;this.isPassed?(this.grass.touchEnabled=!1,this.pointer.stop(),this.timer.stop(),this.transitionPlay(this.round).call(function(){switch(t.pointer.run(),t.timer.start(),t.grass.touchEnabled=!0,t.round){case 1:t.setFarmland(t.constants.Article_Round2,Constants.Locations_Round2),t.target_score=Constants.TargetScore_Round2;break;case 2:t.setFarmland(t.constants.Article_Round3,Constants.Locations_Round3),t.target_score=Constants.TargetScore_Round3;break;case 3:t.setFarmland(t.constants.Article_Round4,Constants.Locations_Round4),t.target_score=Constants.TargetScore_Round4;break;case 4:t.setFarmland(t.constants.Article_Round1,Constants.Locations_Round1),t.target_score=Constants.TargetScore_Round1}t.round++,t.Time_Game=Constants.Time_Game,t.showTargetScore(),t.showTime(),t.showRound(),t.showScore()})):(this.tip.showTips(this.isPassed,this.round),this.grass.touchEnabled=!1,this.pointer.stop(),this.timer.stop(),this.tip.panel_tip.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.round=1,t.sum=0,t.setFarmland(t.constants.Article_Round1,Constants.Locations_Round1),t.grass.touchEnabled=!0,t.Time_Game=Constants.Time_Game,t.target_score=Constants.TargetScore_Round1,t.timer.start(),t.showTime(),t.showScore(),t.showRound(),t.pointer.run(),t.showTargetScore(),t.transitionPlay(0)},this))},e.prototype.setFarmland=function(t,e){var n=this.farmland.$children;console.log("the children left is "+n.length),this.farmland.removeChildren();for(var i=0;i<t.length;i++)this.farmland.add(t[i],e[i])},e.prototype.isWin=function(){switch(this.round){case 1:this.sum-=Constants.TargetScore_Round1;break;case 2:this.sum-=Constants.TargetScore_Round2;break;case 3:this.sum-=Constants.TargetScore_Round3;break;case 4:this.sum-=Constants.TargetScore_Round4}return this.sum>=0?!0:!1},e.prototype.showScore=function(){this.textField_Sum.text=this.sum.toString()},e.prototype.showTargetScore=function(){this.target_TextField.text="Target \n"+this.target_score.toString()},e.prototype.mutiShow=function(){var t=new egret.TextField,e=new egret.TextField,n=new egret.TextField,i=new egret.TextField;this.setTextForm1(t),this.setTextForm1(e),this.setTextForm1(n),this.setTextForm1(i),t.x=770,t.y=590,e.x=840,e.y=590,n.x=900,n.y=590,i.x=970,i.y=590,t.text="15",e.text="25",n.text="40",i.text="50",this.addChild(t),this.addChild(e),this.addChild(n),this.addChild(i)},e.prototype.setTextForm1=function(t){t.textAlign=egret.HorizontalAlign.LEFT,t.textColor=16711680,t.type=egret.TextFieldType.DYNAMIC,t.lineSpacing=6,t.multiline=!0},e.prototype.showRound=function(){},e.prototype.showMessage=function(){},e.prototype.showTime=function(){this.progress_bar.value=this.Time_Game},e.prototype.timeFunction=function(){this.Time_Game--,this.showTime(),0==this.Time_Game&&(this.isPassed=this.isWin(),this.showMessage(),this.update())},e.prototype.setTimer=function(){this.timer=new egret.Timer(1e3,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timeFunction,this),this.timer.start()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Article=function(t){function e(e,n){var i=t.call(this)||this;return i.DefaultTime=1e3,i.type=e,i.size=n,i.createArticle(),i}return __extends(e,t),e.prototype.createArticle=function(){var t=this.createBitmapByName(this.type);t.scaleX=t.scaleY=this.size,this.$setWidth(t.width),this.$setHeight(t.height),this.anchorOffsetX=.5*t.width,this.anchorOffsetY=.6*t.height,this.backTime=this.createBackTime(this.size),this.score=this.calculateScore(),this.addChild(t)},e.prototype.isRemoved=function(){},e.prototype.createBackTime=function(t){return 1.5*t*this.DefaultTime},e.prototype.calculateScore=function(){return this.getValue()*this.size},e.prototype.getValue=function(){var t;switch(this.type){case"carrot_png":t=15;break;case"dandelion_png":t=50;break;case"cabbage_png":t=25;break;case"sweetpotato_png":t=40;break;default:t=0}return t},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.Sprite);__reflect(Article.prototype,"Article");var Constants=function(){function t(){this.Article_Round1=[new Article("cabbage_png",t.size_round1[0]),new Article("cabbage_png",t.size_round1[0]),new Article("cabbage_png",t.size_round1[0]),new Article("cabbage_png",t.size_round1[0]),new Article("cabbage_png",t.size_round1[0]),new Article("carrot_png",t.size_round1[0]),new Article("carrot_png",t.size_round1[0]),new Article("carrot_png",t.size_round1[0]),new Article("stone2_png",1.2),new Article("stone_png",1.2),new Article("stone_png",.8)],this.Article_Round2=[new Article("cabbage_png",t.size_round2[0]),new Article("cabbage_png",1.2),new Article("cabbage_png",t.size_round2[0]),new Article("cabbage_png",t.size_round2[0]),new Article("carrot_png",1.2),new Article("carrot_png",t.size_round2[0]),new Article("carrot_png",.8),new Article("carrot_png",.7),new Article("stone2_png",1.2),new Article("stone_png",1.2),new Article("stone2_png",1.2),new Article("sweetpotato_png",1),new Article("stone2_png",1)],this.Article_Round3=[new Article("dandelion_png",t.size_round3[0]),new Article("sweetpotato_png",1.2),new Article("sweetpotato_png",t.size_round3[0]),new Article("sweetpotato_png",.8),new Article("cabbage_png",t.size_round3[0]),new Article("cabbage_png",1.2),new Article("cabbage_png",t.size_round3[0]),new Article("carrot_png",.7),new Article("carrot_png",t.size_round3[0]),new Article("carrot_png",.6),new Article("stone2_png",1.3),new Article("stone_png",1.2),new Article("stone2_png",1.2),new Article("stone_png",1.3)],this.Article_Round4=[new Article("dandelion_png",t.size_round4[0]),new Article("dandelion_png",1.3),new Article("dandelion_png",t.size_round4[0]),new Article("sweetpotato_png",1.2),new Article("sweetpotato_png",t.size_round4[0]),new Article("sweetpotato_png",.8),new Article("cabbage_png",.9),new Article("cabbage_png",1.2),new Article("cabbage_png",t.size_round4[0]),new Article("carrot_png",.8),new Article("carrot_png",t.size_round4[0]),new Article("carrot_png",.7),new Article("stone2_png",.7),new Article("stone_png",1.6),new Article("stone2_png",1),new Article("stone_png",1.1),new Article("stone2_png",.8),new Article("stone_png",.6)]}return t}();Constants.Locations_Round1=[new egret.Point(80,150),new egret.Point(80,300),new egret.Point(200,200),new egret.Point(100,480),new egret.Point(220,300),new egret.Point(400,350),new egret.Point(400,200),new egret.Point(300,450),new egret.Point(130,400),new egret.Point(300,270),new egret.Point(290,130)],Constants.Locations_Round2=[new egret.Point(80,180),new egret.Point(50,300),new egret.Point(100,400),new egret.Point(200,200),new egret.Point(200,430),new egret.Point(300,250),new egret.Point(400,150),new egret.Point(400,350),new egret.Point(350,400),new egret.Point(400,200),new egret.Point(200,300),new egret.Point(50,100),new egret.Point(280,110)],Constants.Locations_Round3=[new egret.Point(80,100),new egret.Point(140,240),new egret.Point(80,420),new egret.Point(280,350),new egret.Point(200,450),new egret.Point(300,200),new egret.Point(400,150),new egret.Point(400,350),new egret.Point(350,450),new egret.Point(30,210),new egret.Point(400,250),new egret.Point(200,300),new egret.Point(50,320),new egret.Point(200,100)],Constants.Locations_Round4=[new egret.Point(40,180),new egret.Point(50,430),new egret.Point(200,300),new egret.Point(160,150),new egret.Point(320,280),new egret.Point(150,450),new egret.Point(50,300),new egret.Point(280,150),new egret.Point(275,470),new egret.Point(370,160),new egret.Point(350,400),new egret.Point(400,480),new egret.Point(400,300),new egret.Point(240,370),new egret.Point(125,365),new egret.Point(70,100),new egret.Point(240,100),new egret.Point(235,215)],Constants.size_round1=[1,1,1,1],Constants.size_round2=[1,.5,.7,.9],Constants.size_round3=[1,1,1,1],Constants.size_round4=[1,1,1,1],Constants.TargetScore_Round1=50,Constants.TargetScore_Round2=90,Constants.TargetScore_Round3=140,Constants.TargetScore_Round4=190,Constants.Time_Game=60,Constants.btn_tryagain="Try Again",Constants.btn_play="Play",Constants.btn_lookback="Look Back",Constants.msg_failed="Failed",Constants.msg_succeed="Congratuatios",Constants.Num_Round=4,Constants.Point_Round=new egret.Point(340.8,320),Constants.Scale_Round=2,Constants.Scale_Final=.7,Constants.Point_Final=new egret.Point(806,12),Constants.Time_Tween=1e3,Constants.Point_Rubbit=new egret.Point(1200,620),Constants.Scale_Rubbit=.35,Constants.Scale_Rabbit_End=1.1,Constants.Point_Rabbit_End=new egret.Point(500,700),Constants.Point_Worm_Start=new egret.Point(200,600),Constants.Point_Worm_End=new egret.Point(200,200),Constants.Scale_Worm=.5,Constants.Time_Worm=1e3,Constants.Size_Block=50,Constants.point_rabbit_s=new egret.Point(530.62,313.13),Constants.point_farmer_s=new egret.Point(600,300),Constants.Time_Conversation=2800,Constants.loc_progress_bar=new egret.Point(930,320),Constants.Point_Congratuations=new egret.Point(470,400),Constants.Scale_Congratuations=3,Constants.Time_Stay=1e4,Constants.location_targetscore=new egret.Point(1053,20),Constants.size_targetscore=28,__reflect(Constants.prototype,"Constants");var Farmer=function(t){function e(e,n,i){var o=t.call(this)||this;return o.imagename=e,o.initialPoint=n,o.farmland=i,o.set(),o}return __extends(e,t),e.prototype.set=function(){this.armature=this.loadDrangonBone(),this.addChild(this.armature),console.log("the width of the farmer is "+this.width)},e.prototype.loadDrangonBone=function(){var t=RES.getRes("Ubbie_ske_json"),e=RES.getRes("Ubbie_tex_json"),n=RES.getRes("Ubbie_tex_png"),i=new dragonBones.EgretFactory;i.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,e));var o=i.buildArmatureDisplay("ubbie"),s=o.$children,a=s[0].width,r=s[0].height;return console.log("the size of the shade is:"+new egret.Point(a,r).toString()),this.shade=s[0],o.scaleX=o.scaleY=.2,o.anchorOffsetX=.2*o.width*.5,o.anchorOffsetY=.2*o.height,o},e.prototype.run=function(){this.armature.animation.play("walk",0)},e.prototype.stand=function(){this.armature.animation.play("stand",0)},e.prototype.back=function(t){this.armature.animation.play("walk2",0)},e.prototype.dig=function(){this.armature.animation.play("stand",0)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e.prototype.isHitSomething=function(t){var e=!1;return e?!0:!1},e}(egret.DisplayObjectContainer);__reflect(Farmer.prototype,"Farmer");var Farmland=function(t){function e(){var e=t.call(this)||this;return e.loadBg(),e}return __extends(e,t),e.prototype.loadBg=function(){var t=900,e=500;this.$setWidth(t),this.$setHeight(e)},e.prototype.add=function(t,e){t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=e.x,t.y=e.y,this.addChild(t)},e.prototype.remove=function(){},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.Sprite);__reflect(Farmland.prototype,"Farmland");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?i(o):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Pointer=function(t){function e(){var e=t.call(this)||this;return e.mode=0,e.direction=0,e.createPointer(),e}return __extends(e,t),e.prototype.createPointer=function(){this.pointer=this.createBitmapByName("arrow_png");var t=this.createBitmapByName("round_png");t.anchorOffsetX=0,t.anchorOffsetY=.5*t.height,this.anchorOffsetX=.5*this.pointer.width,this.anchorOffsetY=.5*t.height,this.pointer.anchorOffsetX=this.pointer.width,this.pointer.anchorOffsetY=.5*this.pointer.height,t.x=0-this.pointer.width-10,this.addChild(this.pointer),this.addChild(t),this.$setWidth(this.pointer.width),this.$setHeight(t.height),this.addEventListener(egret.Event.ENTER_FRAME,this.changeRotation,this)},e.prototype.run=function(){this.mode=0},e.prototype.changeRotation=function(t){return 0==this.mode?(70==this.pointer.rotation?(this.pointer.rotation-=e.STEP_ROT,this.direction=0):-70==this.pointer.rotation?(this.pointer.rotation+=e.STEP_ROT,this.direction=1):this.direction?this.pointer.rotation+=e.STEP_ROT:this.pointer.rotation-=e.STEP_ROT,this.angle=this.pointer.rotation,!1):(this.angle=this.pointer.rotation,console.log("the pointer rotation now is "+this.angle),!1)},e.prototype.stop=function(){this.mode=1},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.DisplayObjectContainer);Pointer.STEP_ROT=1,__reflect(Pointer.prototype,"Pointer");var Rabbit=function(t){function e(){var e=t.call(this)||this;return e.set(),e}return __extends(e,t),e.prototype.set=function(){this.armature=this.loadDrangonBone(),this.addChild(this.armature),console.log("the width of the farmer is "+this.width)},e.prototype.loadDrangonBone=function(){var t=RES.getRes("rabbit_ske_json"),e=RES.getRes("rabbit_tex_json"),n=RES.getRes("rabbit_tex_png"),i=new dragonBones.EgretFactory;i.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,e));var o=i.buildArmatureDisplay("rabbit");return o.scaleX=o.scaleY=Constants.Scale_Rubbit,o.anchorOffsetX=.2*o.width*.5,o.anchorOffsetY=.2*o.height,o},e.prototype.eat=function(){this.armature.animation.play("eat",0)},e.prototype.stand=function(){this.armature.animation.play("vib",0)},e.prototype.die=function(){this.armature.animation.play("vib",0)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.DisplayObjectContainer);__reflect(Rabbit.prototype,"Rabbit");var StartingUI=function(t){function e(){var e=t.call(this)||this;return e.loadBg(),e}return __extends(e,t),e.prototype.loadBg=function(){var t=this.createBitmapByName("start_png");this.addChild(t),this.setButton(),this.playConversation()},e.prototype.playConversation=function(){var t=this,e=this.createBitmapByName("Yuan1_png"),n=this.createBitmapByName("Bei1_png"),i=this.createBitmapByName("Yuan2_png"),o=this.createBitmapByName("Bei2_png"),s=this.createBitmapByName("Yuan3_png"),a=this.createBitmapByName("Yuan4_png"),r=this.createBitmapByName("Bei3_png"),h=this.createBitmapByName("Yuan5_png");e.visible=!1,n.visible=!1,i.visible=!1,o.visible=!1,s.visible=!1,a.visible=!1,r.visible=!1,h.visible=!1,this.setLocation(e,Constants.point_farmer_s),this.setLocation(n,Constants.point_rabbit_s),this.setLocation(i,Constants.point_farmer_s),this.setLocation(o,Constants.point_rabbit_s),this.setLocation(s,Constants.point_farmer_s),this.setLocation(a,Constants.point_rabbit_s),this.setLocation(r,Constants.point_farmer_s),this.setLocation(h,Constants.point_rabbit_s);var l=egret.Tween.get(e);l.wait(300).call(function(){e.visible=!0}).wait(.5*Constants.Time_Conversation).call(function(){e.visible=!1,n.visible=!0}).wait(Constants.Time_Conversation).call(function(){n.visible=!1,i.visible=!0}).wait(Constants.Time_Conversation).call(function(){i.visible=!1,o.visible=!0}).wait(Constants.Time_Conversation).call(function(){o.visible=!1,s.visible=!0}).wait(Constants.Time_Conversation).call(function(){s.visible=!1,a.visible=!0}).wait(Constants.Time_Conversation).call(function(){a.visible=!1,r.visible=!0}).wait(Constants.Time_Conversation).call(function(){h.visible=!0}).call(function(){t.button.visible=!0})},e.prototype.setLocation=function(t,e){t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=e.x,t.y=e.y,this.addChild(t)},e.prototype.setButton=function(){this.button=new eui.Button,this.button.skinName="resource/eui_skins/ButtonSkin.exml",this.button.name=Constants.btn_play,this.button.label=Constants.btn_play,this.button.x=.5*this.width,this.button.y=.9*this.height,this.button.anchorOffsetX=.5*this.button.width,this.button.anchorOffsetY=.8*this.button.height,this.addChild(this.button),this.button.visible=!1},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.DisplayObjectContainer);__reflect(StartingUI.prototype,"StartingUI");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function o(t){e.call(i,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Transition=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.panel_tip=new eui.Panel,this.panel_tip.horizontalCenter=0,this.panel_tip.verticalCenter=0},e.prototype.showTips=function(t,e){t&&e==Constants.Num_Round?(this.panel_tip.title=Constants.msg_succeed,this.addChild(this.panel_tip)):t||(this.panel_tip.title=Constants.msg_failed,this.addChild(this.panel_tip))},e}(eui.Component);__reflect(Transition.prototype,"Transition");var Worm=function(t){function e(){var e=t.call(this)||this;return e.set(),e}return __extends(e,t),e.prototype.set=function(){this.armature=this.loadDrangonBone(),this.addChild(this.armature),console.log("the width of the farmer is "+this.width)
},e.prototype.loadDrangonBone=function(){var t=RES.getRes("Worm_ske_json"),e=RES.getRes("Worm_tex_json"),n=RES.getRes("Worm_tex_png"),i=new dragonBones.EgretFactory;i.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,e));var o=i.buildArmatureDisplay("worm");return o.scaleX=o.scaleY=Constants.Scale_Worm,o.anchorOffsetX=.2*o.width*.5,o.anchorOffsetY=.2*o.height,o},e.prototype.run=function(){this.armature.animation.play("bone",0)},e.prototype.stop=function(){},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.DisplayObjectContainer);__reflect(Worm.prototype,"Worm");